"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.sourceLoaderPlugin = void 0;
const source_loader_1 = __importDefault(require("@storybook/source-loader"));
function sourceLoaderPlugin() {
    return {
        name: 'storybook-vite-source-loader-plugin',
        enforce: 'pre',
        async transform(src, id) {
            if (id.match(/\.stories\.[jt]sx?$/)) {
                // We need to mock 'this' when calling transform from @storybook/source-loader
                // noinspection JSUnusedGlobalSymbols
                const mockClassLoader = { emitWarning: (message) => console.warn(message), resourcePath: id };
                const code = await source_loader_1.default.call(mockClassLoader, src);
                return {
                    code,
                    map: { mappings: '' },
                };
            }
        },
    };
}
exports.sourceLoaderPlugin = sourceLoaderPlugin;
//# sourceMappingURL=source-loader-plugin.js.map